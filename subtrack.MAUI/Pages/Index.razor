@page "/"

@using subtrack.MAUI.Services.Abstractions
@using subtrack.MAUI.Responses;
@using subtrack.MAUI.DtoExtention;
@inject ISubscriptionsService subscriptionService

<div class="container text-center">
    <div class="row">
        <div class="col">
            <h6 class="pt-1">Monthly</h6>
        </div>
        <div class="col">
            <h5>@($"{_subscriptionsCost:C}")</h5>
        </div>
    </div>
</div>

<div class="container">
    @foreach (var sub in _subscriptions)
    {
        <div class="card border-primary mb-3" style="max-width: 20rem;">
            <div class="card-header">@sub.Subscription.Name</div>
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>Cost</div>
                    <div class="text-right">@($"{sub.Subscription.Cost:C}")</div>
                </div>
            </div>
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>Due Days</div>
                    <div class="text-right">@sub.DueDays</div>
                </div>
            </div>
        </div>
    }
</div>




@code{
    private decimal _subscriptionsCost = 0;
    private IEnumerable<SubscriptionResponse> _subscriptions;

    protected override async void OnInitialized()
    {
        _subscriptionsCost = (await subscriptionService.GetSubscriptions()).GetMonthlyCost();
        _subscriptions = (await subscriptionService.GetSubscriptions()).ToSubscriptionResponses();
    }
}